import{c as Q,j as e,C as T,B as P,r as q,m as pe,R as I,n as ee,q as fe,o as ye,w as Fe,d as be,e as ge,f as E,p as je,v as U,u as D,h as H,x as _}from"./index-hJVCkv7e.js";import{B as M,D as Le,a as ze,b as Ve,c as Ue,d as Ke,X as Qe,e as Ne,i as te,u as ve,P as V,g as we,k as Ge,l as Ze,f as Xe,h as Ye,L as se}from"./badge-C9jT8Gnn.js";import{D as ae,C as Je,e as et,H as G,S as tt,a as st,b as at,c as rt,d as nt,P as it}from"./select-DZvdiNse.js";import{S as re,a as ne,b as ie,c as ce,d as oe,C as ct}from"./sheet-Cij3qWhQ.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],Ce=Q("chef-hat",ot);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M5 12h14",key:"1ays0h"}]],dt=Q("minus",lt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Re=Q("smartphone",mt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]],ht=Q("wine",ut);function xt({orders:s,onConfirmPayment:b,onApproveMobilePayment:h,onRejectMobilePayment:o}){const n=s.filter(r=>r.status==="paid"&&(r.paymentMethod==="cash"||r.paymentMethod==="mobile"&&r.paymentStatus==="pending_approval")),y=r=>r.reduce((g,u)=>g+u.price*u.quantity,0);return e.jsxs("div",{className:"p-4 space-y-4 pb-20",children:[e.jsx("h2",{children:"Pending Payment Confirmation"}),n.length===0?e.jsx(T,{className:"p-8 text-center text-gray-500",children:"No pending confirmations"}):e.jsx("div",{className:"space-y-3",children:n.map(r=>e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{children:["Order #",r.orderNumber||r.id]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Table ",r.tableNumber]}),r.waiterName&&e.jsxs("p",{className:"text-gray-600 text-sm",children:["Waiter: ",r.waiterName]})]}),e.jsx(M,{className:`${r.paymentMethod==="cash"?"bg-green-600":"bg-blue-600"} text-white border-0`,children:r.paymentMethod==="cash"?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"w-3 h-3"}),"Cash"]}):e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Re,{className:"w-3 h-3"}),"Mobile Banking"]})})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("p",{className:"text-gray-600",children:"Total Amount"}),e.jsxs("p",{className:"mt-1",children:["$",y(r.items).toFixed(2)]})]}),r.paymentMethod==="mobile"&&r.paymentImageUrl&&e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Payment Proof:"}),e.jsxs(Le,{children:[e.jsx(ze,{asChild:!0,children:e.jsx(P,{variant:"outline",className:"w-full",children:"View Payment Image"})}),e.jsxs(Ve,{className:"max-w-md",children:[e.jsx(Ue,{children:e.jsxs(Ke,{children:["Payment Proof - Order #",r.orderNumber||r.id]})}),e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:r.paymentImageUrl,alt:"Payment proof",className:"w-full rounded-lg"})})]})]})]}),e.jsx("div",{className:"flex gap-2",children:r.paymentMethod==="mobile"&&r.paymentStatus==="pending_approval"?e.jsxs(e.Fragment,{children:[e.jsxs(P,{className:"flex-1 bg-green-600 hover:bg-green-700",onClick:()=>h(r.id),children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Approve"]}),e.jsxs(P,{variant:"destructive",className:"flex-1",onClick:()=>o(r.id),children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Reject"]})]}):e.jsx(P,{className:"w-full bg-green-600 hover:bg-green-700",onClick:()=>b(r.id),children:"Confirm Payment"})})]})},r.id))})]})}var Z="Collapsible",[pt,Be]=Ne(Z),[ft,le]=pt(Z),Ae=q.forwardRef((s,b)=>{const{__scopeCollapsible:h,open:o,defaultOpen:n,disabled:y,onOpenChange:r,...g}=s,[u,p]=te({prop:o,defaultProp:n??!1,onChange:r,caller:Z});return e.jsx(ft,{scope:h,disabled:y,contentId:ve(),open:u,onOpenToggle:q.useCallback(()=>p(C=>!C),[p]),children:e.jsx(V.div,{"data-state":me(u),"data-disabled":y?"":void 0,...g,ref:b})})});Ae.displayName=Z;var ke="CollapsibleTrigger",qe=q.forwardRef((s,b)=>{const{__scopeCollapsible:h,...o}=s,n=le(ke,h);return e.jsx(V.button,{type:"button","aria-controls":n.contentId,"aria-expanded":n.open||!1,"data-state":me(n.open),"data-disabled":n.disabled?"":void 0,disabled:n.disabled,...o,ref:b,onClick:we(s.onClick,n.onOpenToggle)})});qe.displayName=ke;var de="CollapsibleContent",Pe=q.forwardRef((s,b)=>{const{forceMount:h,...o}=s,n=le(de,s.__scopeCollapsible);return e.jsx(Ge,{present:h||n.open,children:({present:y})=>e.jsx(yt,{...o,ref:b,present:y})})});Pe.displayName=de;var yt=q.forwardRef((s,b)=>{const{__scopeCollapsible:h,present:o,children:n,...y}=s,r=le(de,h),[g,u]=q.useState(o),p=q.useRef(null),C=pe(b,p),N=q.useRef(0),A=N.current,c=q.useRef(0),i=c.current,l=r.open||g,t=q.useRef(l),a=q.useRef(void 0);return q.useEffect(()=>{const f=requestAnimationFrame(()=>t.current=!1);return()=>cancelAnimationFrame(f)},[]),Ze(()=>{const f=p.current;if(f){a.current=a.current||{transitionDuration:f.style.transitionDuration,animationName:f.style.animationName},f.style.transitionDuration="0s",f.style.animationName="none";const R=f.getBoundingClientRect();N.current=R.height,c.current=R.width,t.current||(f.style.transitionDuration=a.current.transitionDuration,f.style.animationName=a.current.animationName),u(o)}},[r.open,o]),e.jsx(V.div,{"data-state":me(r.open),"data-disabled":r.disabled?"":void 0,id:r.contentId,hidden:!l,...y,ref:C,style:{"--radix-collapsible-content-height":A?`${A}px`:void 0,"--radix-collapsible-content-width":i?`${i}px`:void 0,...s.style},children:l&&n})});function me(s){return s?"open":"closed"}var bt=Ae,gt=qe,jt=Pe,O="Accordion",Nt=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[ue,vt,wt]=Xe(O),[X]=Ne(O,[wt,Be]),he=Be(),Se=I.forwardRef((s,b)=>{const{type:h,...o}=s,n=o,y=o;return e.jsx(ue.Provider,{scope:s.__scopeAccordion,children:h==="multiple"?e.jsx(At,{...y,ref:b}):e.jsx(Bt,{...n,ref:b})})});Se.displayName=O;var[Te,Ct]=X(O),[Ie,Rt]=X(O,{collapsible:!1}),Bt=I.forwardRef((s,b)=>{const{value:h,defaultValue:o,onValueChange:n=()=>{},collapsible:y=!1,...r}=s,[g,u]=te({prop:h,defaultProp:o??"",onChange:n,caller:O});return e.jsx(Te,{scope:s.__scopeAccordion,value:I.useMemo(()=>g?[g]:[],[g]),onItemOpen:u,onItemClose:I.useCallback(()=>y&&u(""),[y,u]),children:e.jsx(Ie,{scope:s.__scopeAccordion,collapsible:y,children:e.jsx(Oe,{...r,ref:b})})})}),At=I.forwardRef((s,b)=>{const{value:h,defaultValue:o,onValueChange:n=()=>{},...y}=s,[r,g]=te({prop:h,defaultProp:o??[],onChange:n,caller:O}),u=I.useCallback(C=>g((N=[])=>[...N,C]),[g]),p=I.useCallback(C=>g((N=[])=>N.filter(A=>A!==C)),[g]);return e.jsx(Te,{scope:s.__scopeAccordion,value:r,onItemOpen:u,onItemClose:p,children:e.jsx(Ie,{scope:s.__scopeAccordion,collapsible:!0,children:e.jsx(Oe,{...y,ref:b})})})}),[kt,Y]=X(O),Oe=I.forwardRef((s,b)=>{const{__scopeAccordion:h,disabled:o,dir:n,orientation:y="vertical",...r}=s,g=I.useRef(null),u=pe(g,b),p=vt(h),N=Ye(n)==="ltr",A=we(s.onKeyDown,c=>{if(!Nt.includes(c.key))return;const i=c.target,l=p().filter(m=>!m.ref.current?.disabled),t=l.findIndex(m=>m.ref.current===i),a=l.length;if(t===-1)return;c.preventDefault();let f=t;const R=0,v=a-1,k=()=>{f=t+1,f>v&&(f=R)},$=()=>{f=t-1,f<R&&(f=v)};switch(c.key){case"Home":f=R;break;case"End":f=v;break;case"ArrowRight":y==="horizontal"&&(N?k():$());break;case"ArrowDown":y==="vertical"&&k();break;case"ArrowLeft":y==="horizontal"&&(N?$():k());break;case"ArrowUp":y==="vertical"&&$();break}const d=f%a;l[d].ref.current?.focus()});return e.jsx(kt,{scope:h,disabled:o,direction:n,orientation:y,children:e.jsx(ue.Slot,{scope:h,children:e.jsx(V.div,{...r,"data-orientation":y,ref:u,onKeyDown:o?void 0:A})})})}),K="AccordionItem",[qt,xe]=X(K),$e=I.forwardRef((s,b)=>{const{__scopeAccordion:h,value:o,...n}=s,y=Y(K,h),r=Ct(K,h),g=he(h),u=ve(),p=o&&r.value.includes(o)||!1,C=y.disabled||s.disabled;return e.jsx(qt,{scope:h,open:p,disabled:C,triggerId:u,children:e.jsx(bt,{"data-orientation":y.orientation,"data-state":We(p),...g,...n,ref:b,disabled:C,open:p,onOpenChange:N=>{N?r.onItemOpen(o):r.onItemClose(o)}})})});$e.displayName=K;var Me="AccordionHeader",Ee=I.forwardRef((s,b)=>{const{__scopeAccordion:h,...o}=s,n=Y(O,h),y=xe(Me,h);return e.jsx(V.h3,{"data-orientation":n.orientation,"data-state":We(y.open),"data-disabled":y.disabled?"":void 0,...o,ref:b})});Ee.displayName=Me;var J="AccordionTrigger",_e=I.forwardRef((s,b)=>{const{__scopeAccordion:h,...o}=s,n=Y(O,h),y=xe(J,h),r=Rt(J,h),g=he(h);return e.jsx(ue.ItemSlot,{scope:h,children:e.jsx(gt,{"aria-disabled":y.open&&!r.collapsible||void 0,"data-orientation":n.orientation,id:y.triggerId,...g,...o,ref:b})})});_e.displayName=J;var De="AccordionContent",He=I.forwardRef((s,b)=>{const{__scopeAccordion:h,...o}=s,n=Y(O,h),y=xe(De,h),r=he(h);return e.jsx(jt,{role:"region","aria-labelledby":y.triggerId,"data-orientation":n.orientation,...r,...o,ref:b,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...s.style}})});He.displayName=De;function We(s){return s?"open":"closed"}var Pt=Se,St=$e,Tt=Ee,It=_e,Ot=He;function W({...s}){return e.jsx(Pt,{"data-slot":"accordion",...s})}function F({className:s,...b}){return e.jsx(St,{"data-slot":"accordion-item",className:ee("border-b last:border-b-0",s),...b})}function L({className:s,children:b,...h}){return e.jsx(Tt,{className:"flex",children:e.jsxs(It,{"data-slot":"accordion-trigger",className:ee("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",s),...h,children:[b,e.jsx(et,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function z({className:s,children:b,...h}){return e.jsx(Ot,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...h,children:e.jsx("div",{className:ee("pt-0 pb-4",s),children:b})})}function $t(){const[s,b]=q.useState([]),[h,o]=q.useState(!0);q.useEffect(()=>{const g=fe(be(E,"orders"),Fe("status","==","confirmed"),ye("createdAt","desc")),u=ge(g,p=>{const C=[];p.forEach(N=>{const A=N.data();C.push({id:N.id,...A,createdAt:A.createdAt?.toDate()||new Date})}),b(C),o(!1)});return()=>u()},[]);const n=g=>{const u=[];for(let p=0;p<g.length;p+=10)u.push(g.slice(p,p+10));return u},y=g=>{const u=g.reduce((N,A)=>N+A.items.reduce((c,i)=>c+i.price*i.quantity,0),0),p=g.filter(N=>N.paymentMethod==="cash").length,C=g.filter(N=>N.paymentMethod==="mobile").length;return{totalAmount:u,cashCount:p,mobileCount:C}},r=n(s);return h?e.jsxs("div",{className:"p-4 space-y-4 pb-20",children:[e.jsx("h2",{children:"My Activity History"}),e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading activity history..."})]})})]}):e.jsxs("div",{className:"p-4 space-y-4 pb-20",children:[e.jsx("h2",{children:"My Activity History"}),s.length===0?e.jsx("div",{className:"text-center text-gray-500 py-8",children:"No confirmed payments yet"}):e.jsxs(W,{type:"single",collapsible:!0,children:[r.map((g,u)=>{const p=y(g),C=`$${p.totalAmount.toFixed(2)} (${p.cashCount} Cash, ${p.mobileCount} Mobile)`;return e.jsxs(F,{value:`cashier-batch-${u}`,children:[e.jsxs(L,{children:["History Batch ",u+1," [",C,"] (from ",g.length," Orders)"]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-3",children:g.map(N=>{const A=N.items.reduce((l,t)=>l+t.price*t.quantity,0),c=N.items.reduce((l,t)=>l+t.quantity,0),i=N.items.map(l=>`${l.quantity}x ${l.name}`).join(", ");return e.jsxs(T,{className:"p-3 opacity-75",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-medium",children:["Order #",N.orderNumber||N.id," - Table ",N.tableNumber," - ",N.waiterName||"Unknown Waiter"]}),e.jsx(M,{className:"bg-green-600",children:"Confirmed"})]}),e.jsxs("div",{className:"space-y-1 mb-2",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["âœ“ ",c," items: ",i]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:["Total: $",A.toFixed(2)]}),e.jsx(M,{className:`${N.paymentMethod==="cash"?"bg-green-600":"bg-blue-600"} text-white border-0 flex items-center gap-1`,children:N.paymentMethod==="cash"?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-3 h-3"}),"Cash"]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-3 h-3"}),"Mobile Banking"]})})]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[N.createdAt.toLocaleDateString()," at ",N.createdAt.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]},N.id)})})})]},`cashier-batch-${u}`)}),r.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:"No confirmed payments yet"})]})]})}function Mt({orders:s,onLogout:b}){const[h,o]=q.useState([]),[n,y]=q.useState(""),[r,g]=q.useState(1),u=je(),p={title:u==="am"?"á‹¨á‰¡á‰½áˆ­ á‹¨áˆµáˆ« áŒ£á‰¢á‹«":"Butcher Workstation",historyTitle:u==="am"?"ðŸ“š á‰³áˆªáŠ­ (á‹¨á‰°áŒ áŠ“á‰€á‰ á‰µá‹•á‹›á‹žá‰½)":"ðŸ“š History (Completed Orders)",productionSummary:u==="am"?"á‹¨áˆáˆ­á‰µ áˆ›áŒ á‰ƒáˆˆá‹«":"Production Summary",todoTitle:u==="am"?"ðŸ“‹ á‹¨áˆšá‹°áˆ¨áŒ‰ (á‰ áˆ˜áŒ á‰£á‰ á‰… áˆ‹á‹­) á‰µá‹•á‹›á‹žá‰½":"ðŸ“‹ To-Do List (Pending Orders)",completed:u==="am"?"á‰°áŒ áŠ“á‰‹áˆ":"Completed",prepped:u==="am"?"á‰°á‹˜áŒ‹áŒ€":"Prepped",order:u==="am"?"á‰µá‹•á‹›á‹ #":"Order #",table:u==="am"?"áŒ áˆ¨áŒ´á‹›":"Table",waiter:u==="am"?"áŠ áŒˆáˆáŒ‹á‹­":"Waiter",unknownWaiter:u==="am"?"á‹«áˆá‰³á‹ˆá‰€ áŠ áŒˆáˆáŒ‹á‹­":"Unknown Waiter",historyBatch:u==="am"?"á‹¨á‰³áˆªáŠ­ áŒ¥á‰…áˆ":"History Batch",fromOrders:d=>u==="am"?`áŠ¨ ${d} á‰µá‹•á‹›á‹žá‰½`:`from ${d} Orders`,noCompleted:u==="am"?"á‹¨á‰°áŒ áŠ“á‰€á‰ á‰¡á‰½áˆ­ á‰µá‹•á‹›á‹žá‰½ á‹¨áˆ‰áˆ":"No completed butcher orders yet",noPending:u==="am"?"á‹¨á‰¡á‰½áˆ­ á‹áŒáŒ…á‰µ á‹¨áˆšáˆáˆáŒ‰ á‰µá‹•á‹›á‹žá‰½ á‹¨áˆ‰áˆ":"No pending orders requiring butcher preparation",waitingForButcher:u==="am"?"á‰ á‰¡á‰½áˆ­ áˆ‹á‹­ á‰ áˆ˜áŒ á‰£á‰ á‰… áˆ‹á‹­":"Waiting for Butcher",waitingForBar:u==="am"?"á‰ á‰£áˆ­ áˆ‹á‹­ á‰ áˆ˜áŒ á‰£á‰ á‰… áˆ‹á‹­":"Waiting for Bar"};q.useEffect(()=>{const d=fe(be(E,"menu"),ye("name")),m=ge(d,w=>{const B=w.docs.map(x=>({id:x.id,name:x.data().name,category:x.data().category})).filter(x=>x.category==="Food-Butcher");o(B)});return()=>m()},[]);const C=async()=>{if(!(!n||r<=0))try{const d=s.filter(x=>x.status==="in-kitchen").flatMap(x=>x.items.map((j,S)=>({orderId:x.id,itemName:j.name,itemIndex:S,quantity:j.quantity,requiresButcher:j.requiresButcher||!1,butcherReady:j.butcherReady||!1,createdAt:x.createdAt})).filter(j=>j.itemName===n&&j.requiresButcher&&!j.butcherReady)).sort((x,j)=>x.createdAt.getTime()-j.createdAt.getTime()),m=d.reduce((x,j)=>x+j.quantity,0);if(r>m){alert(`Cannot prep ${r} items. Only ${m} ${n} items are currently pending.`);return}let w=r;const B=[];for(const x of d){if(w<=0)break;const j=Math.min(w,x.quantity);w-=j,B.push({orderId:x.orderId,itemIndex:x.itemIndex})}for(const x of B){const j=s.find(S=>S.id===x.orderId);if(j){const S=[...j.items];S[x.itemIndex]={...S[x.itemIndex],butcherReady:!0},await D(H(E,"orders",x.orderId),{items:S}),await _({role:"Butcher",description:`${S[x.itemIndex].name} (${S[x.itemIndex].quantity}x) prepped via manual control`,orderId:x.orderId,tableNumber:j.tableNumber})}}y(""),g(1)}catch(d){console.error("Error in manual prep:",d)}},N=async(d,m)=>{try{const w=s.find(B=>B.id===d);if(w){const B=w.items.map(j=>j.name===m?{...j,requiresButcher:!0,butcherReady:!0}:j);await D(H(E,"orders",d),{items:B});const x=w.items.find(j=>j.name===m);x&&await _({role:"Butcher",description:`${m} (${x.quantity}x) prepped`,orderId:d,tableNumber:w.tableNumber})}}catch(w){console.error("Error updating order:",w)}},A=()=>{const d=[];return s.forEach(m=>{m.status==="in-kitchen"&&m.items.forEach(w=>{const B=w.requiresButcher!==void 0?w.requiresButcher:!1,x=w.butcherReady!==void 0?w.butcherReady:!0;B&&!x&&d.push({orderId:m.id,itemName:w.name,quantity:w.quantity,tableNumber:m.tableNumber,waiterName:m.waiterName})})}),d},i=(()=>{const d={};return A().forEach(m=>{d[m.itemName]=(d[m.itemName]||0)+m.quantity}),d})(),l=()=>s.filter(d=>d.status==="in-kitchen").filter(d=>d.items.some(m=>(m.requiresButcher!==void 0?m.requiresButcher:!1)&&!(m.butcherReady!==void 0&&m.butcherReady))).sort((d,m)=>d.createdAt.getTime()-m.createdAt.getTime()),t=()=>s.filter(d=>d.items.some(m=>m.requiresButcher)).filter(d=>d.items.every(m=>!m.requiresButcher||(m.butcherReady!==void 0?m.butcherReady:!1))).sort((d,m)=>d.createdAt.getTime()-m.createdAt.getTime()),a=d=>{const m=[];for(let w=0;w<d.length;w+=10)m.push(d.slice(w,w+10));return m},f=d=>{const m={};return d.forEach(w=>{w.items.forEach(B=>{B.requiresButcher!==void 0&&B.requiresButcher&&!(B.butcherReady!==void 0&&B.butcherReady)&&(m[B.name]=(m[B.name]||0)+B.quantity)})}),m},R=l(),v=t(),k=a(R),$=a(v);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-600 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"w-6 h-6 text-white"})}),e.jsx("h2",{children:p.title})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(re,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(P,{variant:"outline",size:"sm",children:e.jsx(G,{className:"w-4 h-4"})})}),e.jsxs(ie,{className:"w-[90vw] max-w-4xl",children:[e.jsx(ce,{children:e.jsx(oe,{children:p.historyTitle})}),e.jsx("div",{className:"mt-4 space-y-4 max-h-[80vh] overflow-y-auto",children:e.jsxs(W,{type:"single",collapsible:!0,children:[$.map((d,m)=>{const w=f(d),B=Object.entries(w).map(([x,j])=>`${x}: ${j}`).join(", ");return e.jsxs(F,{value:`sheet-history-batch-${m}`,children:[e.jsxs(L,{children:[p.historyBatch," ",m+1," [",B,"] (",p.fromOrders(d.length),")"]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-3",children:d.map(x=>e.jsxs(T,{className:"p-3 opacity-75",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-medium",children:[p.order,x.orderNumber||x.id," - ",p.table," ",x.tableNumber," - ",x.waiterName||p.unknownWaiter]}),e.jsx(M,{className:"bg-green-600",children:p.completed})]}),e.jsx("div",{className:"space-y-1",children:x.items.filter(j=>j.requiresButcher).map((j,S)=>e.jsxs("div",{className:"text-sm text-gray-600",children:["âœ“ ",j.quantity,"x ",j.name," (completed)"]},S))})]},x.id))})})]},`sheet-history-batch-${m}`)}),$.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:p.noCompleted})]})})]})]}),e.jsx(P,{variant:"outline",size:"sm",onClick:b,children:e.jsx(se,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs(T,{className:"p-4 bg-blue-50 border-blue-200",children:[e.jsx("h3",{className:"mb-3",children:"ðŸ”ª Manual Preparation Control"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(tt,{value:n,onValueChange:y,children:[e.jsx(st,{className:"w-48",children:e.jsx(at,{placeholder:"Select item type"})}),e.jsx(rt,{children:h.map(d=>e.jsx(nt,{value:d.name,children:d.name},d.id))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>g(Math.max(1,r-1)),disabled:r<=1,children:e.jsx(dt,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-8 text-center",children:r}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>g(r+1),children:e.jsx(it,{className:"w-4 h-4"})})]}),e.jsx(P,{className:"bg-green-600 hover:bg-green-700",onClick:C,disabled:!n,children:"PREPPED"})]})]}),e.jsxs(T,{className:"p-4 bg-orange-50 border-orange-200",children:[e.jsx("h3",{className:"mb-3",children:"Production Summary"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Object.entries(i).map(([d,m])=>e.jsxs(M,{className:"bg-orange-600 text-white border-0 px-4 py-2",children:[d,": ",m]},d))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3",children:p.todoTitle}),e.jsxs(W,{type:"single",collapsible:!0,children:[k.map((d,m)=>{const w=f(d),B=Object.entries(w).map(([x,j])=>`${x}: ${j}`).join(", ");return e.jsxs(F,{value:`batch-${m}`,children:[e.jsxs(L,{children:["Batch ",m+1," [",B,"] (from ",d.length," Orders)"]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-3",children:d.map(x=>e.jsxs(T,{className:"p-3",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("span",{className:"font-medium",children:[p.order,x.orderNumber||x.id," - ",p.table," ",x.tableNumber," - ",x.waiterName||p.unknownWaiter]})}),e.jsx("div",{className:"space-y-2",children:x.items.filter(j=>(j.requiresButcher!==void 0?j.requiresButcher:!1)&&!(j.butcherReady!==void 0&&j.butcherReady)).map((j,S)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("span",{children:[j.quantity,"x ",j.name]}),e.jsx(P,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>N(x.id,j.name),children:p.prepped})]},S))})]},x.id))})})]},`batch-${m}`)}),k.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:p.noPending})]})]}),e.jsx("button",{onClick:()=>window.location.reload(),"aria-label":"Refresh",className:"fixed bottom-20 right-4 bg-orange-600 text-white rounded-full p-3 shadow-lg",title:"Refresh",children:e.jsx(U,{className:"w-5 h-5"})})]})]})}function Et({orders:s,onLogout:b}){const h=s.filter(t=>t.status==="in-kitchen"),o=je(),n={title:o==="am"?"á‹¨áˆáŒá‰¥ á‰¤á‰µ á‹¨áˆµáˆ« áŒ£á‰¢á‹«":"Kitchen Workstation",historyTitle:o==="am"?"ðŸ³ á‹¨áˆáŒá‰¥ á‰¤á‰µ á‰³áˆªáŠ­ (á‹¨á‰°áŒ áŠ“á‰€á‰ á‰µá‹•á‹›á‹žá‰½)":"ðŸ³ Kitchen History (Completed Orders)",productionSummary:o==="am"?"á‹¨áˆáˆ­á‰µ áˆ›áŒ á‰ƒáˆˆá‹«":"Production Summary",orderQueue:o==="am"?"á‹¨á‰µá‹•á‹›á‹ áˆ¨á‹µá":"Order Queue",order:o==="am"?"á‰µá‹•á‹›á‹ #":"Order #",table:o==="am"?"áŒ áˆ¨áŒ´á‹›":"Table",unknownWaiter:o==="am"?"á‹«áˆá‰³á‹ˆá‰€ áŠ áŒˆáˆáŒ‹á‹­":"Unknown Waiter",waitingForButcher:o==="am"?"á‰ á‰¡á‰½áˆ­ áˆ‹á‹­ á‰ áˆ˜áŒ á‰£á‰ á‰… áˆ‹á‹­":"Waiting for Butcher",waitingForBar:o==="am"?"á‰ á‰£áˆ­ áˆ‹á‹­ á‰ áˆ˜áŒ á‰£á‰ á‰… áˆ‹á‹­":"Waiting for Bar",ready:o==="am"?"áˆˆáˆ˜á‹áˆ°á‹µ á‹áŒ áŠá‹":"Ready for Pickup",noCompleted:o==="am"?"á‹¨á‰°áŒ áŠ“á‰€á‰ á‹¨áˆáŒá‰¥ á‰¤á‰µ á‰µá‹•á‹›á‹žá‰½ á‹¨áˆ‰áˆ":"No completed kitchen orders yet"},y=()=>s.filter(t=>t.status==="ready"||t.status==="paid"||t.status==="confirmed"||t.status==="picked").sort((t,a)=>t.createdAt.getTime()-a.createdAt.getTime()),r=t=>{const a=[];for(let f=0;f<t.length;f+=10)a.push(t.slice(f,f+10));return a},g=t=>{const a={};return t.forEach(f=>{f.items.forEach(R=>{a[R.name]=(a[R.name]||0)+R.quantity})}),a},u=y(),p=r(u),C=()=>{const t={};return h.forEach(a=>{a.items.forEach(f=>{t[f.name]=(t[f.name]||0)+f.quantity})}),t},N=t=>`${Math.floor((Date.now()-t.getTime())/6e4)}m`,A=t=>{const a=Math.floor((Date.now()-t.getTime())/6e4);return a<5?"text-green-600":a<10?"text-orange-600":"text-red-600"},c=t=>t.items.every(a=>{const f=a.requiresButcher!==void 0?a.requiresButcher:!1,R=a.butcherReady!==void 0?a.butcherReady:!0,v=a.requiresBar!==void 0?a.requiresBar:!1,k=a.barReady!==void 0?a.barReady:!0;return(!f||R)&&(!v||k)}),i=async t=>{try{const a=s.find(f=>f.id===t);await D(H(E,"orders",t),{status:"ready"}),a&&await _({role:"Kitchen",description:"Order marked ready for pickup",orderId:t,tableNumber:a.tableNumber})}catch(a){console.error("Error marking order ready:",a)}},l=C();return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"w-6 h-6 text-white"})}),e.jsx("h2",{children:n.title})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(re,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(P,{variant:"outline",size:"sm",children:e.jsx(G,{className:"w-4 h-4"})})}),e.jsxs(ie,{className:"w-[90vw] max-w-4xl",children:[e.jsx(ce,{children:e.jsx(oe,{children:n.historyTitle})}),e.jsx("div",{className:"mt-4 space-y-4 max-h-[80vh] overflow-y-auto",children:e.jsxs(W,{type:"single",collapsible:!0,children:[p.map((t,a)=>{const f=g(t),R=Object.entries(f).map(([v,k])=>`${v}: ${k}`).join(", ");return e.jsxs(F,{value:`kitchen-history-batch-${a}`,children:[e.jsxs(L,{children:["History Batch ",a+1," [",R,"] (from ",t.length," Orders)"]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-3",children:t.map(v=>e.jsxs(T,{className:"p-3 opacity-75",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-medium",children:[n.order,v.orderNumber||v.id," - ",n.table," ",v.tableNumber," - ",v.waiterName||n.unknownWaiter]}),e.jsx(M,{className:"bg-green-600",children:v.status==="ready"?n.ready:v.status})]}),e.jsx("div",{className:"space-y-1",children:v.items.map((k,$)=>e.jsxs("div",{className:"text-sm text-gray-600",children:["âœ“ ",k.quantity,"x ",k.name]},$))})]},v.id))})})]},`kitchen-history-batch-${a}`)}),p.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:n.noCompleted})]})})]})]}),e.jsx(P,{variant:"outline",size:"sm",onClick:b,children:e.jsx(se,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs(T,{className:"p-4 bg-red-50 border-red-200",children:[e.jsx("h3",{className:"mb-3",children:n.productionSummary}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Object.entries(l).map(([t,a])=>e.jsxs(M,{className:"bg-red-600 text-white border-0 px-4 py-2",children:[t,": ",a]},t))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3",children:n.orderQueue}),e.jsx("div",{className:"space-y-4",children:h.map(t=>e.jsxs(T,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[n.order,t.orderNumber||t.id]}),e.jsxs("p",{className:"text-gray-600",children:[n.table," ",t.tableNumber," - ",t.waiterName||n.unknownWaiter]})]}),e.jsxs("div",{className:`flex items-center gap-1 ${A(t.createdAt)}`,children:[e.jsx(ct,{className:"w-4 h-4"}),e.jsx("span",{children:N(t.createdAt)})]})]}),e.jsx("div",{className:"space-y-2 mb-4",children:t.items.map((a,f)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("span",{children:[a.quantity,"x ",a.name]}),(a.requiresButcher&&!a.butcherReady||a.requiresBar&&!a.barReady)&&e.jsx(M,{className:"bg-orange-600 text-white border-0",children:a.requiresButcher&&!a.butcherReady?n.waitingForButcher:a.requiresBar&&!a.barReady?n.waitingForBar:n.ready})]},f))}),e.jsx(P,{className:"w-full bg-green-600 hover:bg-green-700",disabled:!c(t),onClick:()=>i(t.id),children:n.ready})]},t.id))})]}),e.jsx("button",{onClick:()=>window.location.reload(),"aria-label":"Refresh",className:"fixed bottom-20 right-4 bg-blue-600 text-white rounded-full p-3 shadow-lg",title:"Refresh",children:e.jsx(U,{className:"w-5 h-5"})})]})]})}function _t({orders:s,onLogout:b}){const h=async(c,i)=>{try{const l=s.find(t=>t.id===c);if(l){const t=l.items.map(v=>v.name===i?{...v,requiresBar:!0,barReady:!0}:v),a=t.filter(v=>v.requiresBar).every(v=>v.barReady),f=a?"ready":l.status;await D(H(E,"orders",c),{items:t,status:f});const R=l.items.find(v=>v.name===i);R&&(await _({role:"Bar",description:`${i} (${R.quantity}x) ready`,orderId:c,tableNumber:l.tableNumber}),a&&f==="ready"&&await _({role:"Bar",description:"Order ready for pickup",orderId:c,tableNumber:l.tableNumber}))}}catch(l){console.error("Error updating order:",l)}},o=async c=>{try{const i=s.find(l=>l.id===c);if(i){const l=i.items.map(t=>t.requiresBar&&!t.barReady?{...t,requiresBar:!0,barReady:!0}:t);await D(H(E,"orders",c),{items:l,status:"ready"}),await _({role:"Bar",description:"Order marked ready for pickup",orderId:c,tableNumber:i.tableNumber})}}catch(i){console.error("Error updating order:",i)}},n=()=>{const c=[];return s.forEach(i=>{(i.status==="at-bar"||i.status==="in-kitchen")&&i.items.forEach(l=>{const t=l.requiresBar!==void 0?l.requiresBar:!1,a=l.barReady!==void 0?l.barReady:!0;t&&!a&&c.push({orderId:i.id,itemName:l.name,quantity:l.quantity})})}),c},y=()=>{const c={};return n().forEach(i=>{c[i.itemName]=(c[i.itemName]||0)+i.quantity}),c},r=n().reduce((c,i)=>(c[i.orderId]||(c[i.orderId]=[]),c[i.orderId].push(i),c),{}),g=()=>s.filter(c=>c.items.some(i=>i.requiresBar)).filter(c=>c.items.every(i=>!i.requiresBar||(i.barReady!==void 0?i.barReady:!1))).sort((c,i)=>c.createdAt.getTime()-i.createdAt.getTime()),u=c=>{const i=[];for(let l=0;l<c.length;l+=10)i.push(c.slice(l,l+10));return i},p=c=>{const i={};return c.forEach(l=>{l.items.forEach(t=>{t.requiresBar!==void 0&&t.requiresBar&&!(t.barReady!==void 0&&t.barReady)&&(i[t.name]=(i[t.name]||0)+t.quantity)})}),i},C=y(),N=g(),A=u(N);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center",children:e.jsx(ht,{className:"w-6 h-6 text-white"})}),e.jsx("h2",{children:"Bar Workstation"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(re,{children:[e.jsx(ne,{asChild:!0,children:e.jsx(P,{variant:"outline",size:"sm",children:e.jsx(G,{className:"w-4 h-4"})})}),e.jsxs(ie,{className:"w-[90vw] max-w-4xl",children:[e.jsx(ce,{children:e.jsx(oe,{children:"ðŸ· Bar History (Completed Orders)"})}),e.jsx("div",{className:"mt-4 space-y-4 max-h-[80vh] overflow-y-auto",children:e.jsxs(W,{type:"single",collapsible:!0,children:[A.map((c,i)=>{const l=p(c),t=Object.entries(l).map(([a,f])=>`${a}: ${f}`).join(", ");return e.jsxs(F,{value:`bar-history-batch-${i}`,children:[e.jsxs(L,{children:["History Batch ",i+1," [",t,"] (from ",c.length," Orders)"]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-3",children:c.map(a=>{const f=a.items.filter(k=>k.requiresBar),R=f.reduce((k,$)=>k+$.quantity,0),v=f.map(k=>`${k.quantity}x ${k.name}`).join(", ");return e.jsxs(T,{className:"p-3 opacity-75",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-medium",children:["Order #",a.orderNumber||a.id," - Table ",a.tableNumber," - ",a.waiterName||"Unknown Waiter"]}),e.jsx(M,{className:"bg-green-600",children:"Completed"})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:["âœ“ ",R," drink",R!==1?"s":""," ready: ",v]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[a.createdAt.toLocaleDateString()," at ",a.createdAt.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]},a.id)})})})]},`bar-history-batch-${i}`)}),A.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:"No completed bar orders yet"})]})})]})]}),e.jsx(P,{variant:"outline",size:"sm",onClick:b,children:e.jsx(se,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs(T,{className:"p-4 bg-purple-50 border-purple-200",children:[e.jsx("h3",{className:"mb-3",children:"Production Summary"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Object.entries(C).map(([c,i])=>e.jsxs(M,{className:"bg-purple-600 text-white border-0 px-4 py-2",children:[c,": ",i]},c))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-3",children:"To-Do List"}),e.jsx("div",{className:"space-y-4",children:Object.entries(r).map(([c,i])=>e.jsxs(T,{className:"p-4",children:[e.jsxs("p",{className:"mb-3 text-gray-600",children:["Order #",s.find(l=>l.id===c)?.orderNumber||c]}),e.jsx("div",{className:"space-y-2 mb-4",children:i.map((l,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsxs("span",{children:[l.quantity,"x ",l.itemName]}),e.jsx(P,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>h(l.orderId,l.itemName),children:"Ready"})]},t))}),e.jsx(P,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>o(c),children:"Mark Order Ready"})]},c))})]}),e.jsx("button",{onClick:()=>window.location.reload(),"aria-label":"Refresh",className:"fixed bottom-20 right-4 bg-purple-600 text-white rounded-full p-3 shadow-lg",title:"Refresh",children:e.jsx(U,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>window.location.reload(),"aria-label":"Refresh",className:"fixed bottom-20 right-4 bg-blue-600 text-white rounded-full p-3 shadow-lg",title:"Refresh",children:e.jsx(U,{className:"w-5 h-5"})})]})]})}const Lt=({role:s,orders:b,pendingOrders:h,currentScreen:o,setCurrentScreen:n,onConfirmPayment:y,onApproveMobilePayment:r,onRejectMobilePayment:g,onLogout:u,t:p})=>s==="cashier"?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[o==="default"&&e.jsx(xt,{orders:h,onConfirmPayment:y,onApproveMobilePayment:r,onRejectMobilePayment:g}),o==="history"&&e.jsx($t,{}),e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t",children:e.jsxs("div",{className:"flex justify-around",children:[e.jsxs("button",{onClick:()=>n("default"),className:`flex-1 flex flex-col items-center py-3 ${o==="default"?"text-blue-600":"text-gray-600"}`,children:[e.jsx(ae,{className:"w-5 h-5"}),e.jsx("span",{className:"mt-1",children:p("pending")})]}),e.jsxs("button",{onClick:()=>n("history"),className:`flex-1 flex flex-col items-center py-3 ${o==="history"?"text-blue-600":"text-gray-600"}`,children:[e.jsx(G,{className:"w-5 h-5"}),e.jsx("span",{className:"mt-1",children:p("history")})]})]})})]}):s==="butcher"?e.jsx(Mt,{orders:b,onLogout:u}):s==="kitchen"?e.jsx(Et,{orders:b,onLogout:u}):s==="bar"?e.jsx(_t,{orders:b,onLogout:u}):null;export{Lt as StaffRoutes};
